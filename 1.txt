SELECT TO_CHAR(A.CREATED_AT, 'YYYY-MM-DD') AS ORDER_DATE, DATE_PART('hour', A.CREATED_AT) AS "HOUR", SUM(A.TOTAL_PRICE - A.TOTAL_TAX) REVENUE, COUNT(*) AS TOTAL_NUMBER_OF_ORDERS
FROM ORDERS A 
 GROUP BY TO_CHAR(A.CREATED_AT, 'YYYY-MM-DD'), DATE_PART('hour', A.CREATED_AT)
 ORDER BY TO_CHAR(A.CREATED_AT, 'YYYY-MM-DD') ASC, DATE_PART('hour', A.CREATED_AT);